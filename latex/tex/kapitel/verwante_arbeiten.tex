\chapter{Verwandte Arbeiten}
\label{chap:relatedWork}

Auch wenn \acp{NNUE} erst seit 2020 in Schachcomputern existieren, haben sie einen großen Einfluss auf die Schachcomputerlandschaft. In der letzten Saison (Saison 22) der \ac{TCEC} \cite{TCEC22} spielen fünf der acht Teilnehmer der höchsten Division mit einer hybriden \ac{NNUE}-Evaluation, die restlichen drei nutzen einen von AlphaZero etablierten \ac{NN} Ansatz, der später in diesem Kapitel genauer erläutert ist.

% AlphaZero: LCZero, Stoofvlees, ScorpioNN, 
% NNUE: Stockfish, KomodoDragon, Igel, rofChade, SlowChess Blitz 

Stockfish war der erste Schachcomputer mit \ac{NNUE} und manifestierte so seine Stellung als stärkster Schachcomputer. Die Entwicklung ist ein Community-Projekt. Das auf SETI@home \cite{SETI2001} basierende Testing Framework Fishtest ermöglicht das Testen tausender Versionen. Alle Änderungen der Codebasis und neue \acp{NNUE} werden durch die Plattform getestet. Stand August 2022 gibt es 289 Entwickler und 1747 Tester, die 126.000 Tests seit der Entstehung der Plattform 2013 durchgeführt haben \cite{FishtestUsers}. Dieser Ansatz ist ein großer Faktor dafür, wie Stockfish der beste Schachcomputer wurde und auch zukünftig bleibt. Die meisten anderen \ac{NNUE}-Schachcomputer bauen auf der Variante von Stockfish auf.
 
Die Architektur der Stockfish \ac{NNUE} ist aktuell in seiner fünften Version. Sie besteht aus einem Feature Set mit 45.056 Eingabeparametern, namens HalfKAv2\_hm, die inkrementell in zwei Farben abhängigen Akkumulatoren aktualisiert werden. Die Ausgabe der Eingabeschicht besteht aus jeweils 520 Ausgabewerten, welche in einen Vektor mit acht Werten und einen mit den restlichen 512 Werten geteilt wird. Die zwei Vektoren mit acht Werten werden basierend auf der Seite angepasst, welche am Zug ist. Anhand der Phase des Spiels wird einer der sogenannten Buckets gewählt. Konkret bestimmt die Anzahl der im Spiel stehenden Figuren die Spielphase: $\left \lfloor\frac{pieceCount-1}{4}\right \rfloor$. Dasselbe Verfahren wird auch zur Auswahl der Schichten der versteckten Schichten verwendet. Die Buckets beinhalten zwei Schichten, die 1024 Werte gewichten und mit einer Clipped \ac{ReLU} oder der Quadratwurzel einer Clipped \ac{ReLU} aktivieren. Alle Schichten sind linear und die Quantisierung wird schon während des Trainings angewandt \cite{StockfishNNUE}.

Der Unterschied von HalfKAv2\_hm zu dem in dieser Arbeit verwendeten HalfKP-Feature Set ist, dass der König selbst als Figur enthalten ist. Jedoch werden die Könige egal welcher Farbe als ein Figurentyp angesehen, da die Belegung ihrer Felder disjunkt ist. Sie stehen also nie auf demselben Feld. So werden acht Prozent der Eingabeparameter gespart. \enquote{hm} steht für \enquote{horizontally mirrored}, auf Deutsch horizontal gespiegelt. Das bedeutet, das Brett wird vor der Erstellung der Eingabeparameter gespiegelt, sodass der eigene König immer auf einem der e bis h (je nach Konvention auch a bis d) Ränge ist. Das hört sich unintuitiv an und spiegelt nicht die Realität wider, eignet sich trotzdem, da es die Größe des Netzes stark reduziert, aber ein Unterschied in Spielstärke kaum messbar ist \cite{StockfishNNUE}.

Schon vor der Entwicklung von \acp{NNUE} gab es einen \ac{NN}-basierten Schachcomputer namens AlphaZero \cite{Silver2017}, der den schon damals \ac{HCE}-basierten Schachcomputer Stockfish vernichtend schlagen konnte. AlphaZero wurde \citeyear{Silver2017} von zu Google gehörendem Forschungsunternehmen DeepMind entwickelt. Es erlernte laut DeepMind bereits nach vier Stunden Self-Play reinforcement Training die nötige Spielstärke, um gegen Stockfish zu gewinnen. DeepMind nennt den Trainingsansatz \emph{tabula rasa}. Nennenswert ist, dass zur Suche \ac{MCTS} anstatt der normalerweise genutzten Alpha-Beta-Suche verwendet wird. AlphaZero kennt nur die Spielregeln und trainiert sein \ac{CNN} durch Self-Play reinforcement Training. Der Ansatz ist generell anwendbar und hat in den Spielen Schach, Shogi und Go gegen die führenden Computerprogramme gewonnen.

Dem erstmals durch einen Schachcomputer geschlagenen damaligen Schachweltmeister \citeauthor{Kasparov2018} \cite{Kasparov2018} gefällt der dynamische und offene Spielstil von AlphaZero, der anders als der von \ac{HCE}-basierten Schachcomputern auf konventionellem Wissen aufbauende Spielstil. Er beschrieb AlphaZero als Experten und nicht als das Werkzeug eines Experten. Damit deutet \citeauthor{Kasparov2018} darauf hin, dass ein Schachspieler, besonders Super-Großmeister, diesen Schachcomputer nicht nur für die Analyse ihrer Züge nehmen kann, sondern auch für das Entdecken neuer Spielweisen, die vorher nicht in Betracht gezogen wurden.

Leider ist AlphaZero nicht öffentlich zugänglich und wird auch von DeepMind nicht weiter entwickelt. Andere Entwickler nutzen jedoch die Herangehensweise von AlphaZero und entwickeln ihr eigenes \ac{NN} nach diesem Ansatz. Der aktuell stärkste Nachfolger heißt \ac{Lc0} \cite{Lc0Homepage}. \ac{Lc0} hat gemessen an der letzten \ac{TCEC}-Saison eine Elo von 3586 \cite{TCEC22} und ist somit wahrscheinlich stärker als AlphaZero. \ac{Lc0} belegte in der 22ten \ac{TCEC}-Saison den dritten Platz hinter den zwei \ac{NNUE}-Schachcomputern Stockfish und Komodo Dragon \cite{KomodoDragon}. Es bleibt spannend, welcher Ansatz sich durchsetzen wird.
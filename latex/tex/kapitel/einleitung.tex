\chapter{Einleitung}

Computerschach ist ein viel betrachtetes Thema. Schon Alan Turing und Claude Shannon haben sich damit befasst \cite{Turing1953, Shannon1950}. In seinem \citeyear{Shannon1950} verfassten Paper beschrieb \citeauthor{Shannon1950} \cite{Shannon1950} die Funktion zu Evaluation einer Schachposition. Ihm war jedoch auch klar, dass es wahrscheinlich niemals eine exakte Evaluation für Schach geben wird. Deshalb liegt es nahe, dafür ein \Ac{NN} zu verwenden, denn dessen Aufgabe ist es, eine solche Funktion zu approximieren. Leider ist es für die Evaluation in einem Schachcomputer wichtig, sowohl genau als auch schnell die Position zu bewerten. Je genauer die Stellung bewertet wird, desto stärker spielt das Programm. Je schneller die Bewertung stattfindet, desto weiter kann der Computer voraussehen, was ebenfalls zu einer höheren Spielstärke führt. Herkömmliche \ac{NN}-Architekturen scheitern jedoch an einer zu langen Berechnungszeit oder bei sehr kleinen Netzen an einer zu ungenauen Bewertung.

Eine Lösung für die Probleme herkömmlicher \acp{NN} wurde \citeyear{YNasu2018} von \citeauthor{YNasu2018} \cite{YNasu2018} in seinem japanischen Paper vorgestellt. Er erkannte, dass inkrementelle Aktualisierungen, wie sie bereits in \ac{HCE} verwendet wurden, in \acp{NN} verwendet werden können. Der Schlüssel dafür ist ein binäres und dünn besetztes Feature Set, basierend auf den Figuren und ihren Positionen. Die sogenannte Feature-Transformator-Schicht muss nicht bei jeder Aktivierung alle Elemente seines Ausgabevektors neu berechnen.

Die \ac{NNUE}-Architektur ist darauf ausgelegt, schnell auf einer CPU zu laufen. Sie nutzt CPU-basierte Optimierungsmöglichkeiten wie \ac{SIMD} und die im letzten Absatz genannten inkrementellen Aktualisierungen, um die Geschwindigkeit zu erlangen und ihre Nutzung als Evaluationsfunktion zu rechtfertigen.

\citeauthor{YNasu2018} \cite{YNasu2018} hat die \ac{NNUE}-Architektur für die Verwendung in der japanischen Schachvariante Shogi entwickelt. Shogi unterscheidet sich in einigen Punkten vom herkömmlichen Schach. Es hat unter anderem eine andere Spielfeldgröße und erlaubt es, geschlagene Figuren wieder einzusetzen. Trotzdem eignet sich \citeauthor{YNasu2018}'s \cite{YNasu2018} Ansatz für traditionelles Schach, da die Zuggenerierung sowie die Evaluation ähnlich ist. Außerdem gibt es in beiden Varianten einen König, praktisch für die Auswahl eines passenden Feature Sets, wie in \autoref{chap:featureSet} genauer erläutert.

Nur zwei Jahre später zeigte eine Portierung des Konzepts starke Verbesserungen in dem Schachcomputer Stockfish, der sich durch \ac{NNUE} um mehr als 80 Elo verbessern konnte \cite{StockfishIntroducingNNUE}, die größte Verbesserung einer Stockfish-Version jemals. Mit Ausnahme von AlphaZero \cite{Silver2017} hatte bis dahin noch kein \ac{NN}-basierter Ansatz Erfolge gezeigt.

% mMtivation für Schachcomputer beschreiben:
% warum ist Schach eine gute Spielweise für Computer Scientist (DeepMind)
% warum werden normale Schachspieler besser durch bessere/andere Schachcomputer (besonders welche mit Neuronalem Netz)

Ein Schachcomputer besteht aus drei Teilen: Suche, Zuggenerierung (Boardrepräsentation) und Evaluation \cite{VazquezFernandez2013}. Als Basis für diese Arbeit wird ein simpler Schachcomputer, der in dem Modul \ac{KIS} entwickelt wurde, verwendet. Dieser Schachcomputer verfügt über eine simple Suche und eine \ac{HCE} \cite{nopy}. Gegenstand dieser Arbeit ist es, die \ac{HCE} des 2021 im Modul \ac{KIS} entwickelten Schachcomputers durch ein eigens trainiertes \ac{NNUE} zu ersetzen. Ziel ist es hierbei nicht, eine neue \ac{NNUE}-Architektur zu präsentieren. Es wird die Architektur verwendet, die von \citeauthor{YNasu2018} \cite{YNasu2018} vorgestellt und auch in der ersten Version der Stockfish \ac{NNUE} verwendet wurde. Der Grund dafür ist, dass sie mit minimalem Domänenwissen auskommt und so ein besseres Bild der Kernelemente der \ac{NNUE}-Architektur vermittelt. Außerdem sollte sie, gemessen an dem Erfolg in Stockfish, ausreichen, um die Spielstärke des in \ac{KIS} entwickelten Schachcomputers zu steigern. Die \ac{NNUE}-Implementierung ist ein Prototyp. Die Erstellung neuer Eingabedaten ist nicht Teil dieser Arbeit.